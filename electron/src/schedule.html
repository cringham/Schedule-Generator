<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>CPSC Department Schedule Generator</title>
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div class="header">
        <h1><a href="index.html">CPSC Department Schedule Generator</a></h1>
    </div>
    <div>
        <button id="Download" class="btn">
            <i class="fa fa-download"></i> Download Schedule
        </button>
        <table id="schedule_table">
            <thead>
                <tr>
                    <th rowspan="2" scope="col">
                        Instructors
                        <a href="prof_data.html"><img class="icon" src="images/edit_icon.png" height="25px" width="25px"></a>
                    </th>
                    <th colspan="5" scope="colgroup">Office Hours</th>
                    <th rowspan="2" scope="col">Course(s)</th>
                    <th rowspan="2" scope="col">Times/Days of Classes</th>
                    <th rowspan="2" scope="col">Rm. No.</th>
                </tr>
                <tr>
                    <th scope="col">M</th>
                    <th scope="col">T</th>
                    <th scope="col">W</th>
                    <th scope="col">Th</th>
                    <th scope="col">F</th>
                </tr>
            </thead>
            <tbody contenteditable="true">
                <tr>
                    <td rowspan="4">Ian Finlayson</td>
                    <td rowspan="4">12 - 2</td>
                    <td rowspan="4"></td>
                    <td rowspan="4">3 - 4</td>
                    <td rowspan="4">12 - 2</td>
                    <td rowspan="4"></td>
                </tr>
                <tr>
                    <td>CPSC 414</td>
                    <td>11am - 12pm MW</td>
                    <td>Trinkle B16</td>
                </tr>
                <tr>
                    <td>CPSC 110</td>
                    <td>9:30am - 11am TR</td>
                    <td>Monroe 112</td>
                </tr>
                <tr>
                    <td>CPSC 240</td>
                    <td>2pm - 3pm MWF</td>
                    <td>Trinkle B6</td>
                </tr>
            </tbody>
            <tbody contenteditable="true">
                <tr>
                    <td rowspan="4">Ian Finlayson</td>
                    <td rowspan="4">12 - 2</td>
                    <td rowspan="4"></td>
                    <td rowspan="4">3 - 4</td>
                    <td rowspan="4">12 - 2</td>
                    <td rowspan="4"></td>
                </tr>
                <tr>
                    <td>CPSC 414</td>
                    <td>11am - 12pm MW</td>
                    <td>Trinkle B16</td>
                </tr>
                <tr>
                    <td>CPSC 110</td>
                    <td>9:30am - 11am TR</td>
                    <td>Monroe 112</td>
                </tr>
                <tr>
                    <td>CPSC 240</td>
                    <td>2pm - 3pm MWF</td>
                    <td>Trinkle B6</td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
    window.$ = window.jQuery = require('jquery');
    </script>
    <script src="generateDepartmentTable.js" type="text/javascript"></script>
    <!--<script type="text/javascript">
      
      function generateDeptTable() {

        var mysql = require('mysql');
        var con = mysql.createConnection({
          host: "localhost",
          user: "root",
          password: "",
          database: "scheduleDB"
        });

        let queryString = "select * from scheduleCSV where Instructors in (select name from professorData) and (Course like \'%CPSC%\' or Course like \'%DATA%\' or Course like \'%CYBR%\' or Course like \'%FSEM%\');"

        con.connect(function(err) {
          if (err) throw err;
          con.query(queryString, function (err, result, fields) {
            if (err) throw err;
            console.log(result); // Store in array - TODO
          });
        });

        let tableHTML = '';
        tableHTML = tableHTML.concat('<thead>');
        tableHTML = tableHTML.concat('<tr>');
        tableHTML = tableHTML.concat('<th rowspan="2" scope="col">');
        tableHTML = tableHTML.concat('Instructors');
        tableHTML = tableHTML.concat('<a href="prof_data.html"><img class="icon" src="images/edit_icon.png" height="25px" width="25px"></a>');
        tableHTML = tableHTML.concat('</th>');
        tableHTML = tableHTML.concat('<th colspan="5" scope="colgroup">Office Hours</th>');
        tableHTML = tableHTML.concat('<th rowspan="2" scope="col">Course(s)</th>');
        tableHTML = tableHTML.concat('<th rowspan="2" scope="col">Times/Days of Classes</th>');
        tableHTML = tableHTML.concat('<th rowspan="2" scope="col">Rm. No.</th>');
        tableHTML = tableHTML.concat('</tr>');
        tableHTML = tableHTML.concat('<tr>');
        tableHTML = tableHTML.concat('<th scope="col">M</th>');
        tableHTML = tableHTML.concat('<th scope="col">T</th>');
        tableHTML = tableHTML.concat('<th scope="col">W</th>');
        tableHTML = tableHTML.concat('<th scope="col">Th</th>');
        tableHTML = tableHTML.concat('<th scope="col">F</th>');
        tableHTML = tableHTML.concat('</tr>');
        tableHTML = tableHTML.concat('</thead>');

        // Each professor gets a <tbody> tag
        for(let i=0; i < ??NUM PROFS??; i++) {

          tableHTML = tableHTML.concat('<tbody contenteditable="true">');

          // Init empty office hour cells
          tableHTML = tableHTML.concat('<tr>');
          for(let i = 0; i < 6; i++) {
            tableHTML = tableHTML.concat('<td rowspan="' + ??NUM CLASSES?? +'"></td>');
          }
          tableHTML = tableHTML.concat('</tr>');

          // Make a <tr> for each class this prof has
          for(let i = 0; i < ??NUM CLASSES??; i++) {
            tableHTML = tableHTML.concat('<tr>');

            tableHTML = tableHTML.concat('<td>' + ??COURSE?? + '</td>');
            tableHTML = tableHTML.concat('<td>' + ??MEETING TIME?? + '</td>');
            tableHTML = tableHTML.concat('<td>' + ??ROOM NUM?? + '</td>');

            tableHTML = tableHTML.concat('</tr>');
          }

          tableHTML = tableHTML.concat('</tbody>');

        }

        document.getElementById('schedule_table').innerHTML = tableHTML;

      }

    </script>-->
    <script>
    window.$ = window.jQuery = require('jquery');
    </script>
    <script type="text/javascript">
    $('#Download').click(function() {

        const html2canvas = require("html2canvas");
        html2canvas(document.querySelector('#schedule_table')).then(function(canvas) {
            console.log(canvas);
            saveAs(canvas.toDataURL(), 'file-name.png');
        });
    });

    function saveAs(uri, filename) {

        var link = document.createElement('a');
        if (typeof link.download === 'string') {
            link.href = uri;
            link.download = filename;
            //Firefox requires the link to be in the body
            document.body.appendChild(link);
            //simulate click
            link.click();
            //remove the link when done
            document.body.removeChild(link);
        } else {
            window.open(uri);
        }
    }
    </script>
</body>

</html>